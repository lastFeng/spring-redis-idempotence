## SpringBoot解决幂等性示例

### 概念

**幂等性**： 通俗的说就是一个接口，多次发起同一个请求，必须保证操作只能执行一次。

比如： 
   
   - 订单接口，不能多次创建相同订单
   - 支付接口，重复支付同一笔订单只能扣款一次
   - 支付宝回调接口，可能会多次回调，必须处理重复回调
   - 普通表单提交接口，因为网络超时等原因多次点击提交，只能成功一次
   
   
### 解决方案

   - 唯一索引 -- 防止新增脏数据
   - token机制 -- 防止页面重复提交
   - 悲观锁 -- 获取数据的时候加锁（锁表或锁行）
   - 乐观锁 -- 基于版本号Version实现，在更新数据校验数据
   - 分布式锁 -- redis 或 zookeeper实现
   - 状态机 -- 状态变更，更新数据时判断状态
   
### 当前实现

   为需要保证幂等性的每一次请求创建一个唯一标识token，先获取token，
   并将此token存入redis，请求接口时，将此token放到header或者作为请求参数请求接口，
   后端接口判断redis中是否存在此token：
   
   如果存在，正常处理业务逻辑，并从redis中删除此token；如果是重复请求，由于token
   已被删除，则不能通过校验，返回请求重复操作提示；如果不存在，说明参数不合法或者
   重复请求，返回提示即可。
   
### 项目简介

   - Spring
   - Redis
   - @ApiIdempotent注解 + 拦截器对请求进行拦截
   - @ControllerAdvice全局异常处理
   - 压测工具：jmeter
   
  **说明**： 
  
  